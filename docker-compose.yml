
services:
  napcat:
    image: mlikiowa/napcat-docker:latest
    container_name: napcat
    restart: always
    ports:
      - "6099:6099" # Web UI for NapCat
    volumes:
      - ./napcat/config:/app/napcat/config
      - ./napcat/qq:/app/.config/QQ
    environment:
      - TZ=Asia/Shanghai
      - WS_ENABLE=true
      - WS_URLS=["ws://qqbot:8080/onebot/v11/ws"]
    networks:
      - bot_net

  bot:
    build: .
    container_name: qqbot
    restart: always
    environment:
      - HOST=0.0.0.0
      - PORT=8080
      - TZ=Asia/Shanghai
      - OPENWEATHER_API_KEY=${OPENWEATHER_API_KEY}
      - TARGET_GROUPS=${TARGET_GROUPS}
    volumes:
      - ./src:/app/src # Mount src for code updates without rebuilding (optional, but useful)
      - ./.env:/app/.env # Mount .env to pass config
      - ./data:/app/data # Mount data directory for persistent storage (RSS, DB, usage)
    depends_on:
      - napcat
    networks:
      - bot_net

networks:
  bot_net:
    driver: bridge
